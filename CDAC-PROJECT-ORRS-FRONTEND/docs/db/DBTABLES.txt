PROJECT ORRS MODIFIED:

FINAL LIST OF 18 DATABASE TABLES — ORRS PROJECT

1.Users – Stores all registered user accounts (Customers, Admins, Staff).
2.Stations – Contains master data of all railway stations.
3.Trains – Holds main details of each train (number, name, type, etc.).
4.Train_Stations – Junction table defining stops (station sequence, timings) for each train.
5.Train_Coach – Defines coaches attached to each train (coach number, type, capacity).
6.Seat – Contains seat-level information for each coach.
7.Booking – Main booking table linking users, trains, and stations with journey details.
8.Passenger – Stores individual passenger details under a booking (supports multiple passengers).
9.Ticket – Represents issued digital/physical tickets linked to a booking.
10.Train_Fare – Defines per-kilometer fare rate for each coach class per train.
11.Payment – Base payment table — records general payment transactions.
12.Payment_Card – Subclass table — stores card-specific payment details.
13.Payment_UPI – Subclass table — stores UPI-specific payment details.
14.Payment_NetBanking – Subclass table — stores net banking payment details.
15.Refund_Logs – Tracks refunds for cancelled bookings (status, amount, mode).
16.Announcements – Stores admin-generated public or system-wide announcements.
17.Feedback – Stores user feedback and ratings related to trains, bookings, or system.
18.User_Logs – Tracks user actions (login, booking, cancellation, profile update, etc.).


1.Users Table:
Purpose: Stores all user (customer/admin/staff) details.

| **Field Name**      | **Data Type**                                                  | **Description / Purpose** |
| ------------------- | -------------------------------------------------------------- | ------------------------- |
| `user_id`           | INT (PK, AUTO_INCREMENT)                                       | Unique ID for each user   |
| `full_name`         | VARCHAR(100)                                                   | User’s full name          |
| `email`             | VARCHAR(100) UNIQUE                                            | Email (used for login)    |
| `password_hash`     | VARCHAR(255)                                                   | Encrypted password        |
| `mobile`            | VARCHAR(15)                                                    | Mobile number             |
| `gender`            | ENUM('Male','Female','Other')                                  | Gender                    |
| `dob`               | DATE                                                           | Date of birth             |
| `address`           | VARCHAR(255)                                                   | Full postal address       |
| `id_type`           | ENUM('Aadhar','PAN','Passport','VoterID')                      | Type of identity proof    |
| `id_number`         | VARCHAR(20)                                                    | ID proof number           |
| `role`              | ENUM('Customer','Admin','Staff') DEFAULT 'Customer'            | Role in system            |
| `account_status`    | ENUM('Active','Inactive','Suspended') DEFAULT 'Active'         | Account current state     |
| `preferred_class`   | ENUM('SL','3A','2A','1A','CC','2S')                            | Preferred travel class    |
| `is_verified_email` | BOOLEAN DEFAULT 0                                              | Email verification status |
| `created_on`        | DATETIME DEFAULT CURRENT_TIMESTAMP                             | Account creation date     |
| `updated_on`        | DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP | Record update timestamp   |
| `is_deleted`        | BOOLEAN DEFAULT 0                                              | Soft delete flag          |

CREATE TABLE users (
  user_id INT AUTO_INCREMENT PRIMARY KEY,
  full_name VARCHAR(100) NOT NULL,
  email VARCHAR(100) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  mobile VARCHAR(15) NOT NULL,
  gender ENUM('Male','Female','Other'),
  dob DATE,
  address VARCHAR(255),
  id_type ENUM('Aadhar','PAN','Passport','VoterID'),
  id_number VARCHAR(20),
  role ENUM('Customer','Admin','Staff') DEFAULT 'Customer',
  account_status ENUM('Active','Inactive','Suspended') DEFAULT 'Active',
  preferred_class ENUM('SL','3A','2A','1A','CC','2S'),
  is_verified_email BOOLEAN DEFAULT 0,
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  updated_on DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  is_deleted BOOLEAN DEFAULT 0
);



2.Stations Table:
Stores all railway station master details.

| **Field Name** | **Data Type**                                                  | **Description / Purpose**  |
| -------------- | -------------------------------------------------------------- | -------------------------- |
| `station_id`   | INT (PK, AUTO_INCREMENT)                                       | Unique ID for each station |
| `station_code` | VARCHAR(10) NOT NULL                                           | Short railway code         |
| `station_name` | VARCHAR(100) NOT NULL                                          | Full station name          |
| `city`         | VARCHAR(100)                                                   | City name                  |
| `state`        | VARCHAR(100)                                                   | State name                 |
| `zone`         | VARCHAR(50)                                                    | Railway zone name          |
| `platforms`    | INT                                                            | Number of platforms        |
| `status`       | ENUM('Active','Inactive','Under Maintenance') DEFAULT 'Active' | Current operational state  |
| `created_on`   | DATETIME DEFAULT CURRENT_TIMESTAMP                             | Record creation date       |

CREATE TABLE stations (
  station_id INT AUTO_INCREMENT PRIMARY KEY,
  station_code VARCHAR(10) NOT NULL,
  station_name VARCHAR(100) NOT NULL,
  city VARCHAR(100),
  state VARCHAR(100),
  zone VARCHAR(50),
  platforms INT,
  status ENUM('Active','Inactive','Under Maintenance') DEFAULT 'Active',
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP
);


3.Trains Table:
Stores all train details.

| **Field Name**           | **Data Type**                                                   | **Description / Purpose**    |
| ------------------------ | --------------------------------------------------------------- | ---------------------------- |
| `train_id`               | INT (PK, AUTO_INCREMENT)                                        | Unique ID for each train     |
| `train_number`           | VARCHAR(10) UNIQUE NOT NULL                                     | Official train number        |
| `train_name`             | VARCHAR(100) NOT NULL                                           | Name of the train            |
| `train_type`             | VARCHAR(50)                                                     | Express, Rajdhani, etc.      |
| `source_station_id`      | INT (FK → stations.station_id)                                  | Starting station             |
| `destination_station_id` | INT (FK → stations.station_id)                                  | Ending station               |
| `total_distance_km`      | INT                                                             | Total route distance         |
| `avg_speed`              | INT                                                             | Average train speed          |
| `days_of_run`            | VARCHAR(50)                                                     | Running days (Mon, Wed, Fri) |
| `train_active_status`    | ENUM('Active','Inactive','Under Maintenance') DEFAULT 'Active'  | Availability status          |
| `status`                 | ENUM('Running','Cancelled','Not Started') DEFAULT 'Not Started' | Operational state            |
| `created_on`             | DATETIME DEFAULT CURRENT_TIMESTAMP                              | Record creation time         |

CREATE TABLE trains (
  train_id INT AUTO_INCREMENT PRIMARY KEY,
  train_number VARCHAR(10) UNIQUE NOT NULL,
  train_name VARCHAR(100) NOT NULL,
  train_type VARCHAR(50),
  source_station_id INT,
  destination_station_id INT,
  total_distance_km INT,
  avg_speed INT,
  days_of_run VARCHAR(50),
  train_active_status ENUM('Active','Inactive','Under Maintenance') DEFAULT 'Active',
  status ENUM('Running','Cancelled','Not Started') DEFAULT 'Not Started',
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (source_station_id) REFERENCES stations(station_id)
    ON DELETE SET NULL ON UPDATE CASCADE,
  FOREIGN KEY (destination_station_id) REFERENCES stations(station_id)
    ON DELETE SET NULL ON UPDATE CASCADE
);

4.Train_Station Table:
Links each train to all its stops (many-to-many).

| **Field Name**         | **Data Type**                      | **Description / Purpose**            |
| ---------------------- | ---------------------------------- | ------------------------------------ |
| `train_station_id`     | INT (PK, AUTO_INCREMENT)           | Unique ID for record                 |
| `train_id`             | INT (FK → trains.train_id)         | Train reference                      |
| `station_id`           | INT (FK → stations.station_id)     | Station reference                    |
| `sequence_no`          | INT                                | Stop sequence order                  |
| `arrival_time`         | TIME                               | Arrival time at station              |
| `departure_time`       | TIME                               | Departure time                       |
| `halt_minutes`         | INT                                | Stop duration                        |
| `distance_from_source` | INT                                | Distance from starting point (in km) |
| `day_number`           | INT                                | Day of journey (1, 2, etc.)          |
| `created_on`           | DATETIME DEFAULT CURRENT_TIMESTAMP | Record creation timestamp            |

CREATE TABLE train_stations (
  train_station_id INT AUTO_INCREMENT PRIMARY KEY,
  train_id INT NOT NULL,
  station_id INT NOT NULL,
  sequence_no INT NOT NULL,
  arrival_time TIME,
  departure_time TIME,
  halt_minutes INT,
  distance_from_source INT,
  day_number INT,
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (train_id) REFERENCES trains(train_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (station_id) REFERENCES stations(station_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  UNIQUE (train_id, station_id)
);


5.Train_Coach table:
Links trains ↔ coaches (each train can have multiple coaches).

| **Field Name** | **Data Type**                       | **Description / Purpose**               |
| -------------- | ----------------------------------- | --------------------------------------- |
| `coach_id`     | INT (PK, AUTO_INCREMENT)            | Unique ID for each coach                |
| `train_id`     | INT (FK → trains.train_id)          | Train reference                         |
| `coach_number` | VARCHAR(10)                         | Coach label (e.g., S1, A1, B2)          |
| `coach_type`   | ENUM('SL','3A','2A','1A','CC','2S') | Type of coach                           |
| `coach_image`  | VARCHAR(255)                        | Path to coach image (for visualization) |
| `total_seats`  | INT                                 | Total number of seats in this coach     |
| `is_active`    | BOOLEAN DEFAULT 1                   | Active coach status                     |
| `is_deleted`   | BOOLEAN DEFAULT 0                   | Soft delete flag                        |
| `created_on`   | DATETIME DEFAULT CURRENT_TIMESTAMP  | Record creation time                    |

CREATE TABLE train_coach (
  coach_id INT AUTO_INCREMENT PRIMARY KEY,
  train_id INT NOT NULL,
  coach_number VARCHAR(10) NOT NULL,
  coach_type ENUM('SL','3A','2A','1A','CC','2S') NOT NULL,
  coach_image VARCHAR(255),
  total_seats INT NOT NULL,
  is_active BOOLEAN DEFAULT 1,
  is_deleted BOOLEAN DEFAULT 0,
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (train_id) REFERENCES trains(train_id)
    ON DELETE CASCADE ON UPDATE CASCADE
);


6.Seat Table:
Stores seat-level details for each coach.

| **Field Name** | **Data Type**                                                             | **Description / Purpose**        |
| -------------- | ------------------------------------------------------------------------- | -------------------------------- |
| `seat_id`      | INT (PK, AUTO_INCREMENT)                                                  | Unique seat ID                   |
| `coach_id`     | INT (FK → train_coach.coach_id)                                           | Related coach                    |
| `seat_number`  | VARCHAR(10)                                                               | Seat number (e.g., 1, 2, L1, S2) |
| `seat_type`    | ENUM('Window','Middle','Aisle','Upper','Lower','Side Upper','Side Lower') | Seat position/type               |
| `is_booked`    | BOOLEAN DEFAULT 0                                                         | 1 if booked                      |
| `is_active`    | BOOLEAN DEFAULT 1                                                         | Active seat flag                 |
| `is_deleted`   | BOOLEAN DEFAULT 0                                                         | Soft delete flag                 |
| `created_on`   | DATETIME DEFAULT CURRENT_TIMESTAMP                                        | Record creation timestamp        |

CREATE TABLE seat (
  seat_id INT AUTO_INCREMENT PRIMARY KEY,
  coach_id INT NOT NULL,
  seat_number VARCHAR(10) NOT NULL,
  seat_type ENUM('Window','Middle','Aisle','Upper','Lower','Side Upper','Side Lower'),
  is_booked BOOLEAN DEFAULT 0,
  is_active BOOLEAN DEFAULT 1,
  is_deleted BOOLEAN DEFAULT 0,
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (coach_id) REFERENCES train_coach(coach_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  UNIQUE (coach_id, seat_number)
);


7.Booking Table:
Main table connecting user ↔ train ↔ stations ↔ passengers.

| **Field Name**           | **Data Type**                                               | **Description / Purpose**       |
| ------------------------ | ----------------------------------------------------------- | ------------------------------- |
| `booking_id`             | INT (PK, AUTO_INCREMENT)                                    | Unique booking ID               |
| `pnr_number`             | VARCHAR(20) UNIQUE                                          | PNR (Passenger Name Record)     |
| `user_id`                | INT (FK → users.user_id)                                    | User who made booking           |
| `train_id`               | INT (FK → trains.train_id)                                  | Train reference                 |
| `source_station_id`      | INT (FK → stations.station_id)                              | Boarding station                |
| `destination_station_id` | INT (FK → stations.station_id)                              | Destination station             |
| `journey_date`           | DATE                                                        | Travel date                     |
| `booking_date`           | DATETIME DEFAULT CURRENT_TIMESTAMP                          | Date of booking                 |
| `total_fare`             | DECIMAL(10,2)                                               | Total fare for all passengers   |
| `booking_type`           | ENUM('Individual','Group') DEFAULT 'Individual'             | Booking type                    |
| `approval_status`        | ENUM('Pending','Approved','Rejected') DEFAULT 'Approved'    | Group booking admin approval    |
| `booking_status`         | ENUM('Confirmed','Cancelled','Pending') DEFAULT 'Confirmed' | Current booking state           |
| `cancellation_date`      | DATETIME                                                    | Cancellation timestamp (if any) |
| `is_active`              | BOOLEAN DEFAULT 1                                           | Record active flag              |
| `is_deleted`             | BOOLEAN DEFAULT 0                                           | Soft delete flag                |
| `created_on`             | DATETIME DEFAULT CURRENT_TIMESTAMP                          | Creation timestamp              |


CREATE TABLE booking (
  booking_id INT AUTO_INCREMENT PRIMARY KEY,
  pnr_number VARCHAR(20) UNIQUE NOT NULL,
  user_id INT NOT NULL,
  train_id INT NOT NULL,
  source_station_id INT NOT NULL,
  destination_station_id INT NOT NULL,
  journey_date DATE NOT NULL,
  booking_date DATETIME DEFAULT CURRENT_TIMESTAMP,
  total_fare DECIMAL(10,2) NOT NULL,
  booking_type ENUM('Individual','Group') DEFAULT 'Individual',
  approval_status ENUM('Pending','Approved','Rejected') DEFAULT 'Approved',
  booking_status ENUM('Confirmed','Cancelled','Pending') DEFAULT 'Confirmed',
  cancellation_date DATETIME,
  is_active BOOLEAN DEFAULT 1,
  is_deleted BOOLEAN DEFAULT 0,
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(user_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (train_id) REFERENCES trains(train_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (source_station_id) REFERENCES stations(station_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (destination_station_id) REFERENCES stations(station_id)
    ON DELETE CASCADE ON UPDATE CASCADE
);


8.Passenger Table:
Each record is a traveler under a booking.

| **Field Name**   | **Data Type**                                     | **Description / Purpose** |
| ---------------- | ------------------------------------------------- | ------------------------- |
| `passenger_id`   | INT (PK, AUTO_INCREMENT)                          | Unique passenger ID       |
| `booking_id`     | INT (FK → booking.booking_id)                     | Booking reference         |
| `seat_id`        | INT (FK → seat.seat_id)                           | Allocated seat            |
| `passenger_name` | VARCHAR(100)                                      | Passenger name            |
| `age`            | INT                                               | Passenger age             |
| `gender`         | ENUM('Male','Female','Other')                     | Passenger gender          |
| `fare`           | DECIMAL(10,2)                                     | Fare for this passenger   |
| `ticket_status`  | ENUM('Confirmed','Cancelled') DEFAULT 'Confirmed' | Current ticket state      |
| `is_active`      | BOOLEAN DEFAULT 1                                 | Record active flag        |
| `is_deleted`     | BOOLEAN DEFAULT 0                                 | Soft delete flag          |
| `created_on`     | DATETIME DEFAULT CURRENT_TIMESTAMP                | Record creation timestamp |

CREATE TABLE passenger (
  passenger_id INT AUTO_INCREMENT PRIMARY KEY,
  booking_id INT NOT NULL,
  seat_id INT,
  passenger_name VARCHAR(100) NOT NULL,
  age INT,
  gender ENUM('Male','Female','Other'),
  fare DECIMAL(10,2),
  ticket_status ENUM('Confirmed','Cancelled') DEFAULT 'Confirmed',
  is_active BOOLEAN DEFAULT 1,
  is_deleted BOOLEAN DEFAULT 0,
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (booking_id) REFERENCES booking(booking_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (seat_id) REFERENCES seat(seat_id)
    ON DELETE SET NULL ON UPDATE CASCADE
);


9.Ticket Table:
Represents issued tickets (PDF or digital).

| **Field Name** | **Data Type**                      | **Description / Purpose**     |
| -------------- | ---------------------------------- | ----------------------------- |
| `ticket_id`    | INT (PK, AUTO_INCREMENT)           | Unique ticket ID              |
| `booking_id`   | INT (FK → booking.booking_id)      | Linked booking                |
| `ticket_url`   | VARCHAR(255)                       | File path to generated ticket |
| `issued_date`  | DATETIME DEFAULT CURRENT_TIMESTAMP | Ticket generation date        |
| `is_active`    | BOOLEAN DEFAULT 1                  | Active ticket flag            |
| `is_deleted`   | BOOLEAN DEFAULT 0                  | Soft delete flag              |

CREATE TABLE ticket (
  ticket_id INT AUTO_INCREMENT PRIMARY KEY,
  booking_id INT NOT NULL,
  ticket_url VARCHAR(255),
  issued_date DATETIME DEFAULT CURRENT_TIMESTAMP,
  is_active BOOLEAN DEFAULT 1,
  is_deleted BOOLEAN DEFAULT 0,
  FOREIGN KEY (booking_id) REFERENCES booking(booking_id)
    ON DELETE CASCADE ON UPDATE CASCADE
);


10.Train_Fare Table:
Defines fare rates for trains and coach classes.

| **Field Name** | **Data Type**                       | **Description / Purpose** |
| -------------- | ----------------------------------- | ------------------------- |
| `fare_id`      | INT (PK, AUTO_INCREMENT)            | Unique fare record ID     |
| `train_id`     | INT (FK → trains.train_id)          | Train reference           |
| `coach_type`   | ENUM('SL','3A','2A','1A','CC','2S') | Coach type                |
| `rate_per_km`  | DECIMAL(5,2)                        | Base fare per km          |
| `min_fare`     | DECIMAL(10,2) DEFAULT 50.00         | Minimum fare              |
| `is_active`    | BOOLEAN DEFAULT 1                   | Active rate flag          |
| `is_deleted`   | BOOLEAN DEFAULT 0                   | Soft delete flag          |
| `created_on`   | DATETIME DEFAULT CURRENT_TIMESTAMP  | Record creation timestamp |

CREATE TABLE train_fare (
  fare_id INT AUTO_INCREMENT PRIMARY KEY,
  train_id INT NOT NULL,
  coach_type ENUM('SL','3A','2A','1A','CC','2S') NOT NULL,
  rate_per_km DECIMAL(5,2) NOT NULL,
  min_fare DECIMAL(10,2) DEFAULT 50.00,
  is_active BOOLEAN DEFAULT 1,
  is_deleted BOOLEAN DEFAULT 0,
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (train_id) REFERENCES trains(train_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  UNIQUE (train_id, coach_type, is_active)
);


11.Payments(Base TAble):
Stores general payment info — all payment types reference this base.

| **Field Name**   | **Data Type**                                                   | **Description / Purpose** |
| ---------------- | --------------------------------------------------------------- | ------------------------- |
| `payment_id`     | INT (PK, AUTO_INCREMENT)                                        | Unique payment ID         |
| `booking_id`     | INT (FK → booking.booking_id)                                   | Related booking           |
| `user_id`        | INT (FK → users.user_id)                                        | User who paid             |
| `amount`         | DECIMAL(10,2)                                                   | Amount paid               |
| `payment_mode`   | ENUM('Card','UPI','NetBanking')                                 | Payment mode              |
| `payment_status` | ENUM('Success','Failed','Pending','Refunded') DEFAULT 'Success' | Current payment status    |
| `payment_date`   | DATETIME DEFAULT CURRENT_TIMESTAMP                              | Date/time of payment      |

CREATE TABLE payment (
  payment_id INT AUTO_INCREMENT PRIMARY KEY,
  booking_id INT NOT NULL,
  user_id INT NOT NULL,
  amount DECIMAL(10,2) NOT NULL,
  payment_mode ENUM('Card','UPI','NetBanking') NOT NULL,
  payment_status ENUM('Success','Failed','Pending','Refunded') DEFAULT 'Success',
  payment_date DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (booking_id) REFERENCES booking(booking_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(user_id)
    ON DELETE CASCADE ON UPDATE CASCADE
);


12.Payment_Card(Subclass Tables):
Stores card-specific payment details.

| **Field Name**     | **Data Type**                     | **Description / Purpose** |
| ------------------ | --------------------------------- | ------------------------- |
| `payment_id`       | INT (PK, FK → payment.payment_id) | Linked payment record     |
| `card_number`      | VARCHAR(20)                       | Masked card number        |
| `card_type`        | ENUM('Debit','Credit')            | Card type                 |
| `card_holder_name` | VARCHAR(100)                      | Name on card              |

CREATE TABLE payment_card (
  payment_id INT PRIMARY KEY,
  card_number VARCHAR(20),
  card_type ENUM('Debit','Credit'),
  card_holder_name VARCHAR(100),
  FOREIGN KEY (payment_id) REFERENCES payment(payment_id)
    ON DELETE CASCADE ON UPDATE CASCADE
);


13.Payment_UPI(Subclass Table):
Stores UPI-specific payment details.

| **Field Name** | **Data Type**                     | **Description / Purpose**       |
| -------------- | --------------------------------- | ------------------------------- |
| `payment_id`   | INT (PK, FK → payment.payment_id) | Linked payment record           |
| `upi_id`       | VARCHAR(50)                       | UPI address (e.g., user@okaxis) |
| `upi_app`      | VARCHAR(50)                       | App used (GPay, PhonePe)        |

CREATE TABLE payment_upi (
  payment_id INT PRIMARY KEY,
  upi_id VARCHAR(50),
  upi_app VARCHAR(50),
  FOREIGN KEY (payment_id) REFERENCES payment(payment_id)
    ON DELETE CASCADE ON UPDATE CASCADE
);


14.Payment_NetBanking(Subclass Table):
Stores net banking-specific payment details.

| **Field Name**        | **Data Type**                     | **Description**             |
| --------------------- | --------------------------------- | --------------------------- |
| `payment_id`          | INT (PK, FK → payment.payment_id) | Links to main payment table |
| `bank_name`           | VARCHAR(100)                      | Name of the bank            |
| `account_holder_name` | VARCHAR(100)                      | Account holder (optional)   |
| `reference_no`        | VARCHAR(50)                       | Bank transaction reference  |
| `ifsc_code`           | VARCHAR(15)                       | IFSC (optional)             |
| `transaction_date`    | DATETIME                          | Date/time of transaction    |
| `status_message`      | VARCHAR(50)                       | Final status                |

CREATE TABLE payment_netbanking (
  payment_id INT PRIMARY KEY,
  bank_name VARCHAR(100) NOT NULL,
  account_holder_name VARCHAR(100),
  reference_no VARCHAR(50) NOT NULL,
  ifsc_code VARCHAR(15),
  transaction_date DATETIME DEFAULT CURRENT_TIMESTAMP,
  status_message VARCHAR(50) DEFAULT 'Success',
  FOREIGN KEY (payment_id) REFERENCES payment(payment_id)
    ON DELETE CASCADE ON UPDATE CASCADE
);


15.Refund_Logs Table:
Tracks all refund-related activities.

| **Field Name**   | **Data Type**                                                           | **Description / Purpose** |
| ---------------- | ----------------------------------------------------------------------- | ------------------------- |
| `refund_id`      | INT (PK, AUTO_INCREMENT)                                                | Unique refund ID          |
| `booking_id`     | INT (FK → booking.booking_id)                                           | Booking being refunded    |
| `user_id`        | INT (FK → users.user_id)                                                | User who requested refund |
| `refund_amount`  | DECIMAL(10,2)                                                           | Amount refunded           |
| `refund_status`  | ENUM('Initiated','Processing','Completed','Failed') DEFAULT 'Initiated' | Refund status             |
| `refund_mode`    | ENUM('Bank','UPI','CreditCard','Wallet','Other')                        | Mode of refund            |
| `transaction_id` | VARCHAR(100)                                                            | Payment gateway reference |
| `initiated_on`   | DATETIME DEFAULT CURRENT_TIMESTAMP                                      | Refund initiation time    |
| `completed_on`   | DATETIME                                                                | Refund completion time    |
| `remarks`        | VARCHAR(255)                                                            | Optional notes or reason  |


CREATE TABLE refund_logs (
  refund_id INT AUTO_INCREMENT PRIMARY KEY,
  booking_id INT NOT NULL,
  user_id INT NOT NULL,
  refund_amount DECIMAL(10,2),
  refund_status ENUM('Initiated','Processing','Completed','Failed') DEFAULT 'Initiated',
  refund_mode ENUM('Bank','UPI','CreditCard','Wallet','Other'),
  transaction_id VARCHAR(100),
  initiated_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  completed_on DATETIME,
  remarks VARCHAR(255),
  FOREIGN KEY (booking_id) REFERENCES booking(booking_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(user_id)
    ON DELETE CASCADE ON UPDATE CASCADE
);


16.Announcements Tables:
Used by admins to broadcast system-wide or train-specific messages.

| **Field Name**    | **Data Type**                                               | **Description / Purpose**      |
| ----------------- | ----------------------------------------------------------- | ------------------------------ |
| `announcement_id` | INT (PK, AUTO_INCREMENT)                                    | Unique announcement ID         |
| `title`           | VARCHAR(150)                                                | Announcement title             |
| `message`         | TEXT                                                        | Detailed announcement message  |
| `audience_type`   | ENUM('All','User','Admin','Manager','Vendor') DEFAULT 'All' | Target audience                |
| `priority`        | ENUM('High','Medium','Low') DEFAULT 'Medium'                | Importance level               |
| `created_by`      | INT (FK → users.user_id)                                    | Admin who created announcement |
| `valid_from`      | DATETIME DEFAULT CURRENT_TIMESTAMP                          | Visibility start time          |
| `valid_to`        | DATETIME                                                    | Expiry time                    |
| `is_active`       | BOOLEAN DEFAULT TRUE                                        | Whether announcement is active |

CREATE TABLE announcements (
  announcement_id INT AUTO_INCREMENT PRIMARY KEY,
  title VARCHAR(150) NOT NULL,
  message TEXT NOT NULL,
  audience_type ENUM('All','User','Admin','Manager','Vendor') DEFAULT 'All',
  priority ENUM('High','Medium','Low') DEFAULT 'Medium',
  created_by INT,
  valid_from DATETIME DEFAULT CURRENT_TIMESTAMP,
  valid_to DATETIME,
  is_active BOOLEAN DEFAULT TRUE,
  FOREIGN KEY (created_by) REFERENCES users(user_id)
    ON DELETE SET NULL ON UPDATE CASCADE
);


17.Feedback Table:
Collects user feedback related to trains, bookings, refunds, etc.

| **Field Name**    | **Data Type**                                            | **Description / Purpose**   |
| ----------------- | -------------------------------------------------------- | --------------------------- |
| `feedback_id`     | INT (PK, AUTO_INCREMENT)                                 | Unique feedback ID          |
| `user_id`         | INT (FK → users.user_id)                                 | User who submitted feedback |
| `train_id`        | INT (FK → trains.train_id)                               | Related train (optional)    |
| `booking_id`      | INT (FK → booking.booking_id)                            | Related booking (optional)  |
| `rating`          | INT CHECK (rating BETWEEN 1 AND 5)                       | Star rating                 |
| `category`        | ENUM('Train','Booking','Refund','AppExperience','Other') | Feedback category           |
| `comments`        | TEXT                                                     | Feedback text               |
| `response_status` | ENUM('Pending','Reviewed','Resolved') DEFAULT 'Pending'  | Response status             |
| `created_on`      | DATETIME DEFAULT CURRENT_TIMESTAMP                       | Feedback date               |
| `resolved_on`     | DATETIME                                                 | Resolution timestamp        |

CREATE TABLE feedback (
  feedback_id INT AUTO_INCREMENT PRIMARY KEY,
  user_id INT NOT NULL,
  train_id INT,
  booking_id INT,
  rating INT CHECK (rating BETWEEN 1 AND 5),
  category ENUM('Train','Booking','Refund','AppExperience','Other') DEFAULT 'Other',
  comments TEXT,
  response_status ENUM('Pending','Reviewed','Resolved') DEFAULT 'Pending',
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  resolved_on DATETIME,
  FOREIGN KEY (user_id) REFERENCES users(user_id)
    ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (train_id) REFERENCES trains(train_id)
    ON DELETE SET NULL ON UPDATE CASCADE,
  FOREIGN KEY (booking_id) REFERENCES booking(booking_id)
    ON DELETE SET NULL ON UPDATE CASCADE
);


18.User_Logs Table:
Tracks user actions (login, logout, booking, cancellation, etc.).

| **Field Name**   | **Data Type**                                                                                                        | **Description / Purpose** |
| ---------------- | -------------------------------------------------------------------------------------------------------------------- | ------------------------- |
| `log_id`         | INT (PK, AUTO_INCREMENT)                                                                                             | Unique log ID             |
| `user_id`        | INT (FK → users.user_id)                                                                                             | Associated user           |
| `action_type`    | ENUM('Login','Logout','Booking','Cancellation','RefundRequest','ProfileUpdate','PasswordChange','ViewTrain','Other') | Type of user action       |
| `description`    | VARCHAR(255)                                                                                                         | Description of activity   |
| `ip_address`     | VARCHAR(50)                                                                                                          | IP address of user        |
| `device_info`    | VARCHAR(150)                                                                                                         | Device/browser details    |
| `success_status` | BOOLEAN DEFAULT TRUE                                                                                                 | Whether action succeeded  |
| `created_on`     | DATETIME DEFAULT CURRENT_TIMESTAMP                                                                                   | Log timestamp             |


CREATE TABLE user_logs (
  log_id INT AUTO_INCREMENT PRIMARY KEY,
  user_id INT NOT NULL,
  action_type ENUM('Login','Logout','Booking','Cancellation','RefundRequest','ProfileUpdate','PasswordChange','ViewTrain','Other') NOT NULL,
  description VARCHAR(255),
  ip_address VARCHAR(50),
  device_info VARCHAR(150),
  success_status BOOLEAN DEFAULT TRUE,
  created_on DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (user_id) REFERENCES users(user_id)
    ON DELETE CASCADE ON UPDATE CASCADE
);


FINAL RELATIONSHIP SUMMARY

| Table            | Foreign Key References          | Delete / Update Action |
| ---------------- | ------------------------------- | ---------------------- |
| `trains`         | → `stations`                    | SET NULL / CASCADE     |
| `train_stations` | → `trains`, `stations`          | CASCADE / CASCADE      |
| `train_coach`    | → `trains`                      | CASCADE / CASCADE      |
| `seat`           | → `train_coach`                 | CASCADE / CASCADE      |
| `booking`        | → `users`, `trains`, `stations` | CASCADE / CASCADE      |
| `passenger`      | → `booking`, `seat`             | CASCADE / SET NULL     |
| `ticket`         | → `booking`                     | CASCADE / CASCADE      |
| `train_fare`     | → `trains`                      | CASCADE / CASCADE      |
| `payment_*`      | → `payment`                     | CASCADE / CASCADE      |
| `refund_logs`    | → `booking`, `users`            | CASCADE / CASCADE      |
| `announcements`  | → `users`                       | SET NULL / CASCADE     |
| `feedback`       | → `users`, `trains`, `booking`  | CASCADE / SET NULL     |
| `user_logs`      | → `users`                       | CASCADE / CASCADE      |


✅ Total Tables: 18
✅ Normalization: 3NF
✅ Cascade Safety: Applied everywhere
✅ Integrity: All FKs verified
✅ Ready for MySQL execution
















